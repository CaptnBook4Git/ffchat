# Bug: Story room named "Story: Story" instead of "Story: [User Name]" on first creation

**Type:** bug

## Description

There is a naming inconsistency when a user creates their first Story Room. Instead of using the user's display name to create a personalized room title (e.g., "story:Alice"), the system defaults to a generic localized string. This results in the room being named "story:Story" because the fallback mechanism prepends the "story:" prefix to the localized word "Story".

This issue specifically occurs during the initial "Add to story" action when no story room exists for the user yet. While the room functions correctly as a story container, the naming does not follow the intended personalized pattern used elsewhere in the fork.

## Current Behavior

When a user triggers the story creation for the first time, the `StoriesBar` widget initiates the room creation with a generic localized fallback.

- **File:** `lib/pages/stories/stories_bar.dart` (line 48)
- **Code:** `future: () => client.getOrCreateOwnStoryRoom(nameFallback: l10n.story),`
- **Result:** The `nameFallback` is "Story" (in English). The utility logic in `lib/utils/own_story_config.dart` then transforms this into "story:Story".

## Expected Behavior

The Story Room should be named using the user's display name to provide a better user experience and clearer identification.
- Expected format: `story:[User Display Name]` (e.g., "story:John Doe")
- Fallback format: `story:My Story` (only if the display name is unavailable)

## Motivation

Personalized room naming helps users identify their own story rooms more easily in the chat list and aligns with the expected behavior for social features in the family-and-friends fork. "Story: Story" is redundant and looks like a placeholder bug to the end user.

## Codebase Analysis

### Affected Files
| File | Component | Relevance |
|------|-----------|-----------|
| `lib/pages/stories/stories_bar.dart` | StoriesBar widget | **Primary** - Passes the generic `l10n.story` instead of user-specific data. |
| `lib/utils/own_story_config.dart` | OwnStoryConfigExtension | **Secondary** - Contains the logic that prepends the "story:" prefix. |

### Current Implementation

In `lib/pages/stories/stories_bar.dart:48`, the `FutureBuilder` or similar trigger calls:
```dart
client.getOrCreateOwnStoryRoom(nameFallback: l10n.story)
```
The `l10n.story` string is fetched from `lib/l10n/intl_en.arb:292` where it is defined as `"Story"`.

The extension in `lib/utils/own_story_config.dart:42-47` processes this:
```dart
final fallbackName = (nameFallback?.trim().isNotEmpty ?? false)
    ? nameFallback!.trim()
    : 'My Story';
final roomName = fallbackName.startsWith('story:')
    ? fallbackName
    : 'story:$fallbackName';
```
Since "Story" does not start with "story:", it becomes "story:Story".

## Upstream Status

- Related upstream issue: None found. This feature is specific to the family-and-friends fork.
- Upstream PR: None.

## Suggested Implementation Plan

1. **Update StoriesBar Logic**: In `lib/pages/stories/stories_bar.dart`, retrieve the current user's display name before calling the room creation.
2. **Handle Profile Fetch**: Use `client.fetchOwnProfile()` or access the cached user profile to get the `displayname`.
3. **Pass Personalized Name**: Update the `getOrCreateOwnStoryRoom` call to use the fetched display name as the `nameFallback`.
4. **Safety Fallback**: Ensure that if the display name is null or empty, it falls back to a more descriptive string like "My Story" instead of just "Story".

## Acceptance Criteria

- [ ] New Story Rooms are created with the format `story:[User Name]`.
- [ ] If no user name is set, the room is named `story:My Story`.
- [ ] Existing Story Rooms remain unaffected.
- [ ] AGPL headers updated on all modified files.
- [ ] `CHANGELOG.md` updated with `[FORK]` entry.

## Technical Notes

- **Network Latency**: Fetching the profile might add a small delay. Consider if the profile is already available in the `client` state to avoid an extra API call.
- **Edge Case**: If the user has a display name that already starts with "story:", the utility logic should handle it correctly without double-prefixing.

## Research References

- Matrix Custom Room Types Research (Internal)
- FluffyChat Navigation and Room Creation analysis

---
*Generated by new-issue-agpl*
